@echo off
chcp 65001 > nul
echo.
echo ===============================================
echo    ðŸš€ Ð—ÐÐŸÐ£Ð¡Ðš AIRFLOW ÐŸÐ ÐžÐ„ÐšÐ¢Ð ðŸš€
echo ===============================================
echo.

:: ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ° Ñ‡Ð¸ Ñ” Docker
echo [1/4] ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ° Docker...
docker --version >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ Docker Ð½Ðµ Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¸Ð¹! Ð¡Ð¿Ð¾Ñ‡Ð°Ñ‚ÐºÑƒ Ð²ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸ Docker Desktop
    echo ðŸ“¥ Ð—Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶Ð¸Ñ‚Ð¸ Ð¼Ð¾Ð¶Ð½Ð° Ñ‚ÑƒÑ‚: https://www.docker.com/products/docker-desktop/
    pause
    exit /b 1
)
echo âœ… Docker Ð·Ð½Ð°Ð¹Ð´ÐµÐ½Ð¸Ð¹

:: ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ° Ñ‡Ð¸ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð¸Ð¹ Docker
echo [2/4] ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ° Ñ‡Ð¸ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð¸Ð¹ Docker...
docker info >nul 2>&1
if %errorlevel% neq 0 (
    echo âŒ Docker Ð½Ðµ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð¸Ð¹! Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸ Docker Desktop ÑÐ¿Ð¾Ñ‡Ð°Ñ‚ÐºÑƒ
    pause
    exit /b 1
)
echo âœ… Docker Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð¸Ð¹

:: Ð—ÑƒÐ¿Ð¸Ð½ÐºÐ° ÑÑ‚Ð°Ñ€Ð¸Ñ… ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ñ–Ð² (ÑÐºÑ‰Ð¾ Ñ”)
echo [3/4] Ð—ÑƒÐ¿Ð¸Ð½ÐºÐ° ÑÑ‚Ð°Ñ€Ð¸Ñ… ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ñ–Ð²...
docker-compose down >nul 2>&1

:: Ð—Ð°Ð¿ÑƒÑÐº Ð¿Ñ€Ð¾Ñ”ÐºÑ‚Ð°
echo [4/4] Ð—Ð°Ð¿ÑƒÑÐº Airflow...
echo â³ Ð¦Ðµ Ð¼Ð¾Ð¶Ðµ Ð·Ð°Ð¹Ð½ÑÑ‚Ð¸ ÐºÑ–Ð»ÑŒÐºÐ° Ñ…Ð²Ð¸Ð»Ð¸Ð½ Ð¿Ñ€Ð¸ Ð¿ÐµÑ€ÑˆÐ¾Ð¼Ñƒ Ð·Ð°Ð¿ÑƒÑÐºÑƒ...
docker-compose up -d

if %errorlevel% neq 0 (
    echo âŒ ÐŸÐ¾Ð¼Ð¸Ð»ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÑƒ!
    pause
    exit /b 1
)

echo.
echo ===============================================
echo    ðŸŽ‰ Ð£Ð¡ÐŸÐ†Ð¨ÐÐ˜Ð™ Ð—ÐÐŸÐ£Ð¡Ðš! ðŸŽ‰
echo ===============================================
echo.
echo ðŸŒ Ð’ÐµÐ±-Ñ–Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Airflow: http://localhost:8080
echo ðŸ‘¤ Ð›Ð¾Ð³Ñ–Ð½: admin
echo ðŸ”‘ ÐŸÐ°Ñ€Ð¾Ð»ÑŒ: admin
echo.
echo ðŸ“Š Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð¸Ñ… PostgreSQL: localhost:5432
echo.
echo ===============================================
echo    ÐšÐžÐ Ð˜Ð¡ÐÐ† ÐšÐžÐœÐÐÐ”Ð˜:
echo ===============================================
echo.
echo ðŸ” ÐŸÐµÑ€ÐµÐ³Ð»ÑÐ½ÑƒÑ‚Ð¸ Ð»Ð¾Ð³Ð¸:
echo    docker-compose logs -f
echo.
echo ðŸ›‘ Ð—ÑƒÐ¿Ð¸Ð½Ð¸Ñ‚Ð¸ Ð¿Ñ€Ð¾Ñ”ÐºÑ‚:
echo    docker-compose down
echo.
echo ðŸ”„ ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ð¸:
echo    docker-compose restart
echo.
echo ðŸ§¹ ÐŸÐ¾Ð²Ð½Ðµ Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ð½Ñ (Ð²Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ Ð²ÑÑ– Ð´Ð°Ð½Ñ–):
echo    docker-compose down -v
echo.
echo ===============================================

:: Ð’Ñ–Ð´ÐºÑ€Ð¸Ñ‚Ð¸ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡Ð½Ð¾
echo ðŸŒ Ð’Ñ–Ð´ÐºÑ€Ð¸Ð²Ð°ÑŽ Ð²ÐµÐ±-Ñ–Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ...
timeout /t 10 /nobreak >nul
start http://localhost:8080

echo.
echo âœ¨ Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! ÐœÐ¾Ð¶ÐµÑˆ Ð·Ð°ÐºÑ€Ð¸Ñ‚Ð¸ Ñ†Ðµ Ð²Ñ–ÐºÐ½Ð¾ Ð°Ð±Ð¾ Ð½Ð°Ñ‚Ð¸ÑÐ½Ð¸ Ð±ÑƒÐ´ÑŒ-ÑÐºÑƒ ÐºÐ»Ð°Ð²Ñ–ÑˆÑƒ
pause >nul
